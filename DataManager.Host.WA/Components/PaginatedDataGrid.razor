@typeparam TItem
@using Microsoft.FluentUI.AspNetCore.Components.Icons.Regular
@using Orientation=Microsoft.FluentUI.AspNetCore.Components.Orientation

@* Actions Row *@
@if (ActionsTemplate != null)
{
    <FluentStack Orientation="Orientation.Horizontal" Style="margin-bottom: 8px;" VerticalAlignment="VerticalAlignment.Center">
        <div style="display: flex; gap: 8px;">
            @ActionsTemplate
        </div>
    </FluentStack>
}

@* Filters Row *@
<FluentStack Orientation="Orientation.Horizontal" Style="margin-bottom: 16px;" VerticalAlignment="VerticalAlignment.Center">
    @if (FiltersTemplate != null)
    {
        <div style="display: flex; gap: 8px;">
            @FiltersTemplate
        </div>
    }
    
    @* Search and Settings are always visible *@
    <div style="display: flex; gap: 8px; margin-left: auto;">
        <FluentSearch Placeholder="@SearchPlaceholder"
                      @bind-Value="@SearchTerm"
                      @bind-Value:after="HandleSearchChanged"
                      Style="width: 300px;" />
        
        <FluentButton IconStart="@(new Size20.Settings())" OnClick="@OpenSettingsPanelAsync" />
    </div>
</FluentStack>

<RadzenDataGrid @ref="_dataGrid"
                Data="@Items"
                LoadData="@OnLoadData"
                Count="@TotalItems"
                TItem="TItem"
                AllowFiltering="@AllowFiltering"
                AllowSorting="@AllowSorting"
                AllowPaging="@AllowPaging"
                PageSize="@PageSize"
                SettingsChanged="SettingsChanged"
                AllowColumnResize="true"
                ColumnResized="ColumnResized"
                LoadSettings="LoadRadzenDataGridSettings"
                FilterPopupRenderMode="PopupRenderMode.OnDemand"
                SelectionMode="@SelectionMode"
                Value="@SelectedRows"
                ValueChanged="@OnSelectionChanged">
    <Columns>
        @Columns
    </Columns>
</RadzenDataGrid>
